{
    "collab_server" : "",
    "contents" : "#From this point on:\n#\n#Everything that exists is an object.\n#Everything that happens is a function call.\n\nsetwd(\"D:/Share Point/OneDrive/Comprehensive Exam - Data files\")\n\nlibrary(foreign)\nlibrary(stargazer)\nlibrary(plyr)\nlibrary(reshape)\n\noptions(scipen = 999, digits=2)\nFiles <- list.files(pattern = \"*.csv\")\n\n#Initializing Functions\nna.zero <- function (x) {\n  x[is.na(x)] <- 999\n  return(x)\n}\n\nData <- lapply(Files[1:9], read.csv)\ntaluk.all <- list()\nfor (i in 1:9){\n  taluk.all[[i]] <- Data[[i]][,4]\n}\ntaluk.all <- Reduce(intersect, taluk.all)\n\n#category <- c(3, 5, 6, 7, 8, 10)\nmanage <- c(1, 2, 3, 4)\ntaluk <- c(\"AFZALPUR\", \"ALAND\", \"BAGEPALLY\", \"BANGARAPETE\", \"CHANNAPATNA\", \"CHIKKABALLAPUR\", \"CHINCHOLI\", \"CHINTAMANI\", \"CHITTAPUR\", \"DEVANAHALLI\", \"DODDABALLAPURA\", \"GOWRIBIDANUR\", \"GUDIBANDA\", \"GULBARGA NORTH\", \"GULBARGA SOUTH\", \"HOSAKOTE\", \"JEWARGI\", \"K G F\", \"KANAKAPURA\", \"KOLAR\", \"MAGADI\", \"MALUR\", \"MULBAGAL\", \"NELAMANGALA\", \"RAMANAGARA\", \"SEDAM\", \"SHAHAPUR\", \"SHORAPUR\", \"SIDLAGHATTA\", \"SRINIVASAPUR\", \"YADGIR\")\nexclude <- c(\"SOUTH1\", \"ANEKAL\", \"SOUTH2\", \"SOUTH3\", \"SOUTH4\", \"NORTH4\", \"NORTH1\", \"NORTH2\", \"NORTH3\")\n\nk <- data.frame(matrix(0, nrow = 30, ncol = 9))\nk[,1:4] <- c(2, 1, 4, 8, 9, 15, 18, 20, 22, 23, 28:31, 36, 44:49, 51, 55:62)\nk[,5] <- c(1, 2, 4, 9, 10, 16, 19, 21, 23, 24, 29:32, 37, 46, 51:55, 57, 62:69)\nk[,6] <- c(1, 2, 4, 9, 10, 16, 19, 21, 23, 24, 29:32, 37, 46, 51:55, 57, 61:68)\nk[,7] <- c(2, 1, 4, 9, 10, 16, 19, 21, 23, 24, 29:32, 36, 45, 50:54, 56, 60:67)\nk[,8] <- c(2, 1, 4, 9, 10, 16, 19, 21, 23, 24, 29:32, 37, 46, 51:55, 57, 61:68)\nk[,9] <- c(1, 2, 4, 9, 10, 16, 19, 21, 23, 24, 29:32, 37, 46, 51:55, 57, 61:68)\n\nYear <- c(2005:2013)\n\nfor(i in 1:9){\n  Data[[i]] <- Data[[i]][,k[,i]]\n  colnames(Data[[i]]) <- c(\"Dist_Name\", \"School_Code\", \"Block_Name\", \"Rural_Urban\", \"Medium\", \"Sch_Management\", \"Sch_Category\", \"School_Type\", \"No_of_Working_Days\", \"No_of_Acad_Inspection\", \"School_Dev_Grant_Recd\", \"School_Dev_Grant_Expnd\", \"TLM_Grant_Recd\", \"TLM_Grant_Expnd\", \"Tot_Clrooms\", \"Toilet_Girls\", \"Electricity\", \"Boundary_Wall\", \"Library\", \"PlayGround\", \"Blackboard\", \"Drinking_Water\", \"Male_Tch\", \"Female_Tch\", \"NoResp_Tch\", \"Head_Teacher\", \"Graduate_Teachers\", \"Tch_with_Prof_Qual\", \"Days_involved_in_non_tch_assgn\", \"Teachers_involved_in_non_tch_assgn\")\n  Data[[i]] <- na.zero(Data[[i]])\n  Data[[i]]$acyear <- Year[i]\n}\n\n#setting up a table to match districts with taluks\nlookup <- unique(Data[[9]][,c(1, 3)])\n\nData <- ldply(Data)\n#Data <- droplevels(subset(Data, eval(is.element(Data$Sch_Category, category))))\nData <- droplevels(subset(Data, eval(is.element(Data$Block_Name, taluk.all))))\nData <- droplevels(subset(Data, eval(is.element(Data$Block_Name, exclude) == 0)))\nData[Data$Toilet_Girls >= 1, 16] = 1\nData[eval(Data$Electricity == 2 | Data$Electricity == 3), 17] = 0\nData[Data$Library == 2, 19] = 0\nData[Data$PlayGround == 2, 20] = 0\nData[Data$Rural_Urban == 2, 4] = 0\nData$Public <- rep(0, nrow(Data))\nData[is.element(Data[,6], manage), 32] = 1\nData$Split <- rep(0, nrow(Data))\nData[is.element(Data[,3], taluk), 33] = 1\n\n\n#casting\nSchoolcode <- Data[, c(3, 31, 2)]\nSchoolcode <- cast(Schoolcode, Block_Name ~ acyear, length)\nSchoolcode <- data.frame(merge(lookup, Schoolcode, by = \"Block_Name\"))\ncolnames(Schoolcode) <- c(\"Taluk\", \"District\", \"Yr2005\", \"Yr2006\", \"Yr2007\", \"Yr2008\", \"Yr2009\", \"Yr2010\", \"Yr2011\", \"Yr2012\", \"Yr2013\")\n\n#Set up to Aggregate\nDataset <- Data[,-c(1, 2, 5:8, 18, 21, 22, 25, 26)]\nDataset <- aggregate(Dataset, by = list(Data$Block_Name, Data$acyear), mean)[,-c(2, 3)]\ncolnames(Dataset)[1] <- \"Block_Name\"\nDataset <- data.frame(merge(lookup, Dataset, by = \"Block_Name\"))\n\nSchoolcode <- Schoolcode[,-1]\nDistSchool <- aggregate(Schoolcode, by = list(Schoolcode$District), mean)[,-2]\ncolnames(DistSchool)[1] <- \"District\"\n\n#Preparing to write files\nData <- Data[,-1]\nData <- data.frame(merge(lookup, Data, by = \"Block_Name\"))\n#write.csv(Data, \"Dataset.csv\")\n\nsetwd(\"D:/Share Point/OneDrive/GitHub/greek-salad\")\nwrite.csv(Dataset, \"ssa_taluk.csv\")\nwrite.csv(DistSchool, \"SchoolNo.csv\")\n",
    "created" : 1467787034221.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4084631939",
    "id" : "60DCFC29",
    "lastKnownWriteTime" : 1467216901,
    "last_content_update" : 1467216901,
    "path" : "D:/Share Point/OneDrive/GitHub/greek-salad/DataPrep.R",
    "project_path" : "DataPrep.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}